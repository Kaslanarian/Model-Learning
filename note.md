[toc]

## 层次分析

==解决评价类问题==，可用打分解决，因素`<->`权重

|           | 指标权重 | 方案1 | 方案2 | ...  |
| --------- | -------- | ----- | ----- | ---- |
| **指标1** |          |       |       |      |
| **指标2** |          |       |       |      |
| **...**   |          |       |       |      |
|           |          |       |       |      |

$\sum w_i=1$，同一指标各方案权重和为1

#### 用分治法考虑指标权重

指标两两比较，最后形成完整的权重；

```pseudocode
function Compare(A, B): /*A，B为两指标*/
if Compare(B, A)已知:
	return 1/Compare(B, A)
elseif A和B同等重要:
	return 1
elseif A比B稍微重要：
	return 3
elseif A比B明显重要：
	return 5
elseif A比B强烈重要：
	return 7
elseif A比B极端重要：
	return 9
```

|           | 指标1 | 指标2 | 指标3 |
| --------- | ----- | ----- | ----- |
| **指标**1 | 1     | 2     | 5     |
| **指标**2 | 1/2   | 1     | 1/4   |
| **指标**3 | 1/5   | 4     | 1     |

判断矩阵中$A_{ij}$就是$i$相对于$j$的重要程度，同样可以有：

| 指标X     | 方案1     | 方案2 |
| --------- | --------- | ----- |
| **方案1** | 1         | 3     |
| **方案2** | $\frac13$ | 1     |

此时存在矛盾现象（不一致）

应总有：
$$
a_{ij}a_{jk}=a_{ik}\leftrightarrow 各行各列成比例\leftrightarrow A是一致矩阵\leftrightarrow rank(A)=1,\lambda_1=tr(A)=n,\lambda_i=0(i>1)
$$
一致性指标：$CI=\dfrac{\lambda_{max}-n}{n-1}$，平均随机一致性指标$RI$（查表），判断矩阵的一致性比例$CR=\dfrac{CI}{RI}<0.1$才可以接受，否则要修正。

对于不一致的判断矩阵，不能只对第一列归一化，而是分别计算各列的权重，并将对应算术(==或集合==)平均作为真实权重：
$$
\omega_i=\dfrac1n\sum_{j=1}^n\dfrac{a_{ij}}{\sum_{k=1}^na_{kj}},i=1,2,\cdots,n
$$
**特征值法**：求最大特征值对应的特征向量进行归一化就是各项权重（使用最多）

 ## 优劣解距离法(TOPSIS)

若只有一个指标：构造计算评分的公式：
$$
f(x)=\dfrac{x-min}{max-min}
$$
指标分为极大型指标（效益性指标）和极小型指标（成本性指标）；对极小型指标要进行==指标正向化==：
$$
f(x)=max-x
$$
量纲不同需要标准化处理：$n$个要评价的对象，$m$个指标（已经正向化）
$$
X=\begin{bmatrix}
x_{11}&x_{12}&\cdots x_{1m}\\
x_{21}&\cdots\\
\vdots\\
x_{n1}
\end{bmatrix}\longrightarrow Z:z_{ij}=\dfrac{x_{ij}}{\sqrt{\sum_{i=1}^nx_{ij}^2}}
$$

```matlab
matlab : repmat函数
```

若$Z$是已经标准化处理后的数据矩阵：定义第$i$个评价对象与最大值的距离：

```matlab
D_max = norm(Z(i) - max(Z))
```

最小值类似：

```matlab
D_min = norm(Z(i) - min(Z))
```

从而有未归一化的得分：$S_i=\dfrac{D_{min}}{D_{max}+D_{min}}$

事实上还有两种指标：中间型指标(PH值)，区间型指标(体温)

中间型指标正向化：
$$
M=max\{|x_i-x_{best}|\},\tilde{x}_i=1-\dfrac{|x_i-x_{best}|}{M}
$$
区间型指标正向化：最佳区间为$[a,b]$:
$$
M=\max\{a-\min\{x_i\},\max\{x_i\}-b\}\\
\tilde x_i=
\begin{cases}
1-\dfrac{a-x}{M},x<a  \\
1,a\le x\le b\\
1-\dfrac{x-b}M,x>b
\end{cases}
$$
步骤：正向化$\to$标准化$\to$计算得分并归一化

#### 基于熵权法对`Topsis`模型的修正

熵权法是一种客观赋权的方法，依据的原理：==指标的变异程度越小，所反映的信息量就越少，其对应的权值也应该越低。==（客观=数据本身就可以告诉我们权重）

> 越有可能发生的事情，信息量月少；反之信息量越多

信息熵：$x$为事情发生的情况，$p(x)$为概率，定义
$$
\begin{aligned}
I(x)&=-\ln(p(x))\\
H(x)&=\sum_{i=1}^n[p(x_i)I(x_i)]=-\sum_{i=1}^n[p(x_i)\ln p(x_i)]
\end{aligned}
$$
信息熵是对信息量的期望值。信息熵越大，<u>已知</u>信息量越小

计算方法：给定已正向化矩阵$X_{n\times m}$，标准化后为$Z$，再计算概率矩阵$P$:
$$
p_{ij}=\dfrac{z_{ij}}{\sum_{i=1}^n z_{ij}}
$$
再算信息熵和信息效用值：对第$j$个指标而言，其信息熵计算公式为：
$$
e_j=-\dfrac1{\ln n}\sum_{i=1}^np_{ij}\ln(p_{ij}),j=1,2,\cdots,m\\
信息效用值d_j=1-e_j
$$
将信息效用值归一化，得到每个指标的熵权：$W_j=d_j/\sum d$

## 插值算法

1. 分段多项式作为插值函数：分段差值；
2. 一个多项式插值：多项式插值；
3. $P(x)$是三角多项式：三角插值（很少用）

**定理**：$n+1$个互不相同的节点存在唯一$n$次多项式插值。

**$Runge$现象**：高次插值产生极大波动和明显震荡，所以不应轻易使用高次插值

分段低次插值可以提高插值精度（分段线性插值，分段二次插值）

牛顿插值、拉格朗日插值都存在龙格现象，因此用得少；

埃尔米特插值：具有节点的导数值约束的插值